---------------------------iptables----------------------------
-A добавление нового правила. -p протокол. --dport порт. -m модуль. -s источник. -j действие. 
-A INPUT/OUTPUT -s 192.168.80.1/24 -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT/DROP/LOG --log-prefix "error" (ACCEPT, DROP или LOG входящий или исходящий трафик по порту и ip)
-A INPUT/OUTPUT -p tcp -m state --state NEW -m tcp --dport 67 -j ACCEPT/DROP/LOG --log-prefix "error" (разрешаем, запрещаем или логируем входящий или исходящий трафик по указанному порту)
-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT (разрешаем уже установленное соединение в обе стороны)
-A INPUT -p tcp -m tcp --dport 80 -m limit --limit 20/minute --limit-burst 100 -j ACCEPT(от DDos, значения подбираются индивидуально для каждого сервера исходя из рабочей нагрузки на него)
--limit 20/minute максимальная средняя частота положительных результатов в секунду, минуту, час, день. После числа можно указывать единицы second, minute, hour, day
--limit-burst number ограничивает исходное число пропускаемых пакетов - это число увеличивается на единицу каждый раз когда ограничение на частоту положительных результатов не достигается 

NEW - пакеты, устанавливающие новое соединение
ESTABLISHED - пакеты, принадлежащие установленному соединению
RELATED - пакеты, не принадлежащие установленному соединению 
Пакеты, являющиеся частью новых соединений, инициированые уже установленным ESTABLISHED соединением