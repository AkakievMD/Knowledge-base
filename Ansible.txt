--- (начало любого playbook)
- name: install (имя Playbook)
  hosts: all (хост на котором будет выполнятся задание)
  accelerate: true (увеличивает производительность в 2-4 раза) (узнать получше)
  become: yes (значит что нужно выполнить от root)
  any_errors_fatal: true (любая ошибка в любом задании отменит работу всего playbook на всех хостах, указывается по желанию)

  vars: (под ним создаем переменные со значениями)
    source_file: ./hallo.txt (имя пременной и ее значение, если копируем из одного в другой то нужно правильно указать откуда берем и куда отправляем)
    destin_file: /root/ansible/hi.txt (имя пременной и ее значение)
    secret: 30968350640690  (переменная)  
    ssh_public_keys:
     - { src: /root/.ssh/autorized_keys, dest: /root/ansible } (проверить)

  tasks: (ниже создаем параметры задания)
  - name: install packs (имя задания)
    vars: (ниже перечисляем пакеты которые планируем установить ввиде списка переменных, этот способ подходит если нужно сделать много установок не создавая для каждой программы задачу) 
     packages:(создаем переменную и перечисляем пакеты и программы)но можно и через цикл-> - name: install with cycle (имя задания)
       - wget                                                                                apt: name={{ item }} state=latest (пакетный менедер, имена пакетов в цикле и статус состояния)
       - mc                                                                                  loop: (ниже перечисляем имена пакетов для установки через этот цикл)         
       - neofetch                                                                             - httpd 
       - curl                                                                                 - httpd-devel                  
       - git                                                                                  - wget           
    apt: name='{{ packages }}' state=latest (пакетный менедер, имя того что устанавливаем и статус версии) 
    when: ansible_os_family == "Debian" and/or ansible_distribution_version == "20.04" (пример того как можно использовать условия в задании с любым из логических операторов) 
             
  - shell: apt list --upgradable && apt upgrade или так touch /root/red.txt (пример того как запускать команды на удаленном хосте)
  - shell: uptime (если хочешь посмотреть результат команды на контроллере то его можно сохранить в переменную) 
    register: result (модуль сохранения вывода, создаем переменную в которую запишем вывод)
    failed_when: result.rc == 0 или "'World' in result.stdout"(совпадение в условии отменит работу всего playbook на хосте, указывается по желанию, при обычных ошибках также остановится)

  - name: download from git
    git: (ниже указываем репозиторий с которого скачаем и конечную точку) (проверить)
     repo: https://github.com/drush-ops/drush.git (репозиторий)
     dest: /opt/drush  (куда будет скачано)

  - debug: (ниже указываем переменную из которой считаем результат команды на удаленном хосте)
      var: result (переменная из модуля register) (но также можно сделать вывод значения и обычной переменной)

  - name: install web (имя задания, разовая установка)
    yum: name=nginx state=latest (пакетный менедер, имя того что устанавливаем и статус версии)
    when: ansible_os_family == "RedHat" and ansible_distribution_version == "7.9" (пример того как можно использовать условия в задании с любым из логических операторов)

  - name: Coping Myhome (имя задания)
    copy: src={{ source_file }} dest={{ destin_file }} mode=0777 owner=angelo group=angelo(модуль копирования, откуда берем и куда отправляем и права для файла)
    notify: Restart web (напоминание что нужно сделать рестарт службы в этой точке, отсюда его и вызываем)

  - file: path=/root/ansible/retyty state=directory (модуль создания папки по указанному пути и статус того что создаем - это папка или файл)
    delegate_to: angeloT2(альтернатива для назначения задания на хост по имени, создавать папку по пути лучше модулем file. И через shell создаст, но выдаст ошибку exist, если делегируем)

  - debug: (ниже можно указать ввиде сообщения с переменной) (иной пример)
      msg: "Secretnoe {{ secret }}" (вывод в виде сообщения)

  - name: start web (имя задания)
    service: name=nginx state=started enabled=yes (модуль сервиса, имя сервиса, ожидаемое состояние и состояние в которое нужно привести)
   
  handlers: (для перезапуска служб и сам по себе он не сработает, его нужно вызвать в указанной точке в playbook) 
  - name: Restart web (имя задания)
    service: name=nginx state=restarted (модуль сервиса, имя сервиса, ожидаемое состояние)